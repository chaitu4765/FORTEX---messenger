<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FORTEX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Disable right-click context menu */
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Hide scrollbars but keep functionality */
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        
        /* Blur effect for screenshot protection */
        .screenshot-blur {
            filter: blur(0px);
            transition: filter 0.1s;
        }
        
        /* Message input styling */
        .message-input {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body class="bg-black font-sans">
    <!-- Welcome Page (NEW) -->
    <div id="welcomePage" class="hidden min-h-screen flex items-center justify-center bg-black">
        <div class="bg-gray-900 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center">
            <!-- Logo with black background, now rectangle -->
            <div class="flex justify-center mb-6">
                <div class="bg-black rounded-lg p-2 shadow-lg">
                    <img src="FORTEX.png" alt="FORTEX Logo" class="w-40 h-20 object-contain" style="background:black;">
                </div>
            </div>
            <h1 class="text-4xl font-bold text-white mb-4">Welcome to FORTEX!</h1>
            <p class="text-gray-300 mb-8">Your privacy is our priority. Enjoy secure, encrypted messaging.</p>
            <button id="goToLoginBtn" class="bg-purple-700 hover:bg-purple-800 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200">
                Go to Login
            </button>
        </div>
    </div>

    <!-- Login Page (UPDATED) -->
    <div id="loginPage" class="min-h-screen flex items-center justify-center bg-black">
        <div class="bg-gray-900 p-8 rounded-2xl shadow-2xl w-full max-w-md">
            <div class="text-center mb-8">
                <!-- Logo with black background, now rectangle -->
                <div class="flex justify-center mb-4">
                    <div class="bg-black rounded-lg p-2 shadow-lg">
                        <img src="FORTEX.png" alt="FORTEX Logo" class="w-32 h-16 object-contain" style="background:black;">
                    </div>
                </div>
                <h1 class="text-3xl font-bold text-white">Login to FORTEX</h1>
                <p class="text-gray-300 mt-2">Please enter your credentials</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-2">Username</label>
                    <input type="text" id="username" required 
                           class="w-full px-4 py-3 border border-gray-700 bg-gray-800 text-white rounded-lg focus:ring-2 focus:ring-purple-700 focus:border-transparent outline-none transition-all message-input"
                           placeholder="Enter your username">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-200 mb-2">Password</label>
                    <input type="password" id="password" required 
                           class="w-full px-4 py-3 border border-gray-700 bg-gray-800 text-white rounded-lg focus:ring-2 focus:ring-purple-700 focus:border-transparent outline-none transition-all message-input"
                           placeholder="Enter your password">
                </div>
                
                <button type="submit" 
                        class="w-full bg-purple-700 hover:bg-purple-800 text-white font-semibold py-3 px-4 rounded-lg transition-colors duration-200 transform hover:scale-105">
                    Sign In
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <button id="goToWelcomeBtn" class="text-purple-400 hover:underline text-sm">Go to Welcome Page</button>
            </div>
        </div>
    </div>

    <!-- Main Chat App -->
    <div id="chatApp" class="hidden min-h-screen bg-black">
        <!-- Header -->
        <div class="bg-gray-900 text-white p-4 shadow-lg">
            <div class="flex items-center justify-between max-w-6xl mx-auto">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-8 bg-black rounded-lg flex items-center justify-center">
                        <img src="FORTEX.png" alt="FORTEX Logo" class="w-10 h-6 object-contain" style="background:black;">
                    </div>
                    <div>
                        <h1 class="text-xl font-semibold text-white">FORTEX</h1>
                        <p class="text-purple-300 text-sm">Protected messaging</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <span id="currentUser" class="text-sm bg-gray-800 px-3 py-1 rounded-full"></span>
                    <button id="logoutBtn" class="bg-gray-800 hover:bg-gray-700 px-4 py-2 rounded-lg text-sm transition-colors">
                        Logout
                    </button>
                </div>
            </div>
        </div>

        <div class="max-w-6xl mx-auto flex h-screen">
            <!-- Sidebar -->
            <div class="w-1/3 bg-gray-900 border-r border-gray-800 flex flex-col">
                <!-- Search -->
                <div class="p-4 border-b border-gray-800">
                    <div class="relative">
                        <input type="text" placeholder="Search conversations..." 
                               class="w-full pl-10 pr-4 py-2 border border-gray-700 bg-gray-800 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-purple-700 message-input">
                        <svg class="w-5 h-5 text-gray-400 absolute left-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                    </div>
                </div>

                <!-- Contacts List -->
                <div class="flex-1 overflow-y-auto hide-scrollbar">
                    <div id="contactsList" class="space-y-1 p-2">
                        <!-- Contacts will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Chat Area -->
            <div class="flex-1 flex flex-col bg-black">
                <!-- Chat Header -->
                <div id="chatHeader" class="bg-gray-900 p-4 border-b border-gray-800 shadow-sm hidden">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-purple-700 rounded-full flex items-center justify-center text-white font-semibold">
                            <span id="chatAvatar">J</span>
                        </div>
                        <div>
                            <h3 id="chatName" class="font-semibold text-white">John Doe</h3>
                            <p class="text-sm text-purple-400">Online</p>
                        </div>
                    </div>
                    <!-- Call Buttons -->
                    <div class="flex items-center space-x-2 mt-2 justify-end">
                        <button id="audioCallBtn" title="Audio Call" class="bg-green-600 hover:bg-green-700 text-white p-2 rounded-full transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10v3a3 3 0 01-6 0v-3m9 4v2a2 2 0 01-2 2H7a2 2 0 01-2-2v-2m12-4V7a2 2 0 00-2-2H7a2 2 0 00-2 2v3"/>
                            </svg>
                        </button>
                        <button id="videoCallBtn" title="Video Call" class="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-full transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M4 6h8a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V8a2 2 0 012-2z"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Messages Area -->
                <div id="messagesArea" class="flex-1 overflow-y-auto hide-scrollbar p-4 space-y-4 screenshot-blur bg-black">
                    <div class="text-center text-gray-500 py-8">
                        <svg class="w-16 h-16 mx-auto mb-4 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                        <p class="text-lg text-gray-300">Select a conversation to start messaging</p>
                        <p class="text-sm mt-2 text-gray-500">Your messages are end-to-end encrypted</p>
                    </div>
                </div>

                <!-- Message Input -->
                <div id="messageInput" class="bg-gray-900 p-4 border-t border-gray-800 hidden">
                    <div class="flex items-center space-x-3">
                        <button class="p-2 text-gray-400 hover:text-white rounded-full hover:bg-gray-800">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"/>
                            </svg>
                        </button>
                        <div class="flex-1 relative">
                            <input type="text" id="messageText" placeholder="Type a message..." 
                                   class="w-full px-4 py-3 border border-gray-700 bg-gray-800 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-purple-700 message-input">
                        </div>
                        <button id="sendBtn" class="bg-purple-700 hover:bg-purple-800 text-white p-3 rounded-full transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Security measures
        let isBlurred = false;
        
        // Disable right-click context menu
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Disable common keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+S, Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
            if (e.keyCode === 123 || 
                (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74)) ||
                (e.ctrlKey && (e.keyCode === 85 || e.keyCode === 83 || e.keyCode === 65 || e.keyCode === 67 || e.keyCode === 86 || e.keyCode === 88)) ||
                e.keyCode === 44) { // Print Screen
                e.preventDefault();
                return false;
            }
        });
        
        // Screenshot protection - blur content when window loses focus
        window.addEventListener('blur', function() {
            document.querySelectorAll('.screenshot-blur').forEach(el => {
                el.style.filter = 'blur(10px)';
            });
            isBlurred = true;
        });
        
        window.addEventListener('focus', function() {
            if (isBlurred) {
                document.querySelectorAll('.screenshot-blur').forEach(el => {
                    el.style.filter = 'blur(0px)';
                });
                isBlurred = false;
            }
        });
        
        // Disable drag and drop
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // App state
        let currentUser = '';
        let activeChat = null;
        let messages = {};
        
        // Sample contacts
        const contacts = [
            { id: 1, name: 'MEGHANA', avatar: 'J', lastMessage: 'Hey there!', time: '2:30 PM', online: false },
            { id: 2, name: 'SARAYUU', avatar: 'S', lastMessage: 'See you tomorrow', time: '1:15 PM', online: true },
            { id: 3, name: 'VAISHNAVI', avatar: 'M', lastMessage: 'Thanks for the help', time: '12:45 PM', online: true },
            { id: 4, name: 'VANDHANA', avatar: 'E', lastMessage: 'Perfect!', time: '11:30 AM', online: true },
            { id: 5, name: 'CHAITANYA', avatar: 'A', lastMessage: 'Let me check', time: 'Yesterday', online: false }
        ];
        
        // Initialize sample messages
        contacts.forEach(contact => {
            messages[contact.id] = [
                { sender: contact.name, text: contact.lastMessage, time: contact.time, isOwn: false }
            ];
        });
        
        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                currentUser = username;
                document.getElementById('currentUser').textContent = username;
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('chatApp').classList.remove('hidden');
                loadContacts();
            }
        });
        
        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            currentUser = '';
            activeChat = null;
            document.getElementById('chatApp').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        });
        
        // Load contacts
        function loadContacts() {
            const contactsList = document.getElementById('contactsList');
            contactsList.innerHTML = '';
            
            contacts.forEach(contact => {
                const contactEl = document.createElement('div');
                contactEl.className = 'flex items-center p-3 hover:bg-gray-50 cursor-pointer rounded-lg transition-colors';
                contactEl.innerHTML = `
                    <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold mr-3">
                        ${contact.avatar}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center justify-between">
                            <h4 class="font-semibold text-white truncate">${contact.name}</h4>
                            <span class="text-xs text-gray-300">${contact.time}</span>
                        </div>
                        <p class="text-sm text-white truncate">${contact.lastMessage}</p>
                        <div class="flex items-center mt-1">
                            <div class="w-2 h-2 rounded-full ${contact.online ? 'bg-green-500' : 'bg-gray-400'} mr-2"></div>
                            <span class="text-xs text-gray-300">${contact.online ? 'Online' : 'Offline'}</span>
                        </div>
                    </div>
                `;
                
                contactEl.addEventListener('click', () => openChat(contact));
                contactsList.appendChild(contactEl);
            });
        }
        
        // Show call modal (simple alert for demo)
        function showCallModal(type, contactName) {
            alert(type + " call with " + contactName + " (feature coming soon)");
        }

        // Attach call button listeners after chat is opened
        function attachCallListeners(contact) {
            document.getElementById('audioCallBtn').onclick = function() {
                showCallModal("Audio", contact.name);
            };
            document.getElementById('videoCallBtn').onclick = function() {
                showCallModal("Video", contact.name);
            };
        }

        // Open chat
        function openChat(contact) {
            activeChat = contact;
            document.getElementById('chatHeader').classList.remove('hidden');
            document.getElementById('messageInput').classList.remove('hidden');
            document.getElementById('chatAvatar').textContent = contact.avatar;
            document.getElementById('chatName').textContent = contact.name;

            loadMessages(contact.id);
            attachCallListeners(contact); // <-- add this line
        }
        
        // Load messages
        function loadMessages(contactId) {
            const messagesArea = document.getElementById('messagesArea');
            messagesArea.innerHTML = '';
            
            const contactMessages = messages[contactId] || [];
            
            contactMessages.forEach(message => {
                const messageEl = document.createElement('div');
                messageEl.className = `flex ${message.isOwn ? 'justify-end' : 'justify-start'}`;
                
                messageEl.innerHTML = `
                    <div class="max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${
                        message.isOwn 
                            ? 'bg-green-500 text-white rounded-br-sm' 
                            : 'bg-white text-gray-800 rounded-bl-sm shadow-sm'
                    }">
                        <p class="text-sm">${message.text}</p>
                        <p class="text-xs mt-1 ${message.isOwn ? 'text-green-100' : 'text-gray-500'}">${message.time}</p>
                    </div>
                `;
                
                messagesArea.appendChild(messageEl);
            });
            
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }
        
        // Send message
        function sendMessage() {
            const messageText = document.getElementById('messageText');
            const text = messageText.value.trim();
            
            if (text && activeChat) {
                const now = new Date();
                const time = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                if (!messages[activeChat.id]) {
                    messages[activeChat.id] = [];
                }
                
                messages[activeChat.id].push({
                    sender: currentUser,
                    text: text,
                    time: time,
                    isOwn: true
                });
                
                messageText.value = '';
                loadMessages(activeChat.id);
                
                // Simulate response after 1-3 seconds
                setTimeout(() => {
                    const responses = [
                        "hello, how are you?",
                        "I'm good, thanks!", "That's great to hear!",
                        "What about you?", "Doing well, thank you!", "Glad to hear that!",
                        "What are you up to?", "Just working on some projects.", "Sounds interesting!", "Tell me more about it.",
                        "Sure! I'm building a new app.", "Wow, that sounds exciting!", "Good luck with that!",
                        "Thanks! I appreciate it.", "No problem!", "Let me know if you need any help.",
                        "Will do, thanks again!"  
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    messages[activeChat.id].push({
                        sender: activeChat.name,
                        text: randomResponse,
                        time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                        isOwn: false
                    });
                    
                    loadMessages(activeChat.id);
                }, Math.random() * 2000 + 1000);
            }
        }
        
        // Send button click
        document.getElementById('sendBtn').addEventListener('click', sendMessage);
        
        // Enter key to send
        document.getElementById('messageText').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Additional security: Disable print
        window.addEventListener('beforeprint', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Disable save page
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.keyCode === 83) {
                e.preventDefault();
                return false;
            }
        });
        
        // Show Welcome Page
        document.getElementById('goToWelcomeBtn').addEventListener('click', function() {
            document.getElementById('loginPage').classList.add('hidden');
            document.getElementById('welcomePage').classList.remove('hidden');
        });

        // Back to Login from Welcome
        document.getElementById('goToLoginBtn').addEventListener('click', function() {
            document.getElementById('welcomePage').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9837cfbca2fe46c5',t:'MTc1ODYwNzExOS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
